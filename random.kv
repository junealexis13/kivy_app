#:import Button kivy.uix.button.Button
#:import Label kivy.uix.label.Label

ScrManager:
    WelcomeScreen
    MainMenu
    Menu_Stats
    Menu_Chars
    Menu_Resources
    Menu_Userprofile


<WelcomeScreen>:
    name: "splashscreen"
    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height
        padding: root.width*0.05,root.height*0.1
        
        Image:
            source: "images/logo/logo.png"
            size_hint: (1,1)
            pos_hint: {"center_x": 0.5}

        NavButton:
            text: ""
            size_hint: (0.7, 0.1)
            pos_hint: {"center_x": 0.5}
            font_size: 10
            font_color: (0,0,0,0)
            on_press:
                root.on_press_animation()
            on_release: 
                root.on_release_animation()
                app.root.current = "mainmenu"
                root.manager.transition.direction = "left"

            Image:
                id: splash_image
                source: "images/button/main_menu_hd.png"
                size: (self.parent.width*0.8, self.parent.height*0.8)
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y
                     
<MainMenu>:
    name: "mainmenu"
    GridLayout:
        cols: 2
        rows: 1
        size_hint: (1,0.06)
        pos_hint: {"center_x": 0.5, "center_y": 1-(0.06/2)}

        TestLabel:
            text: "Main Menu"
            size_hint: (0.8,0.8)

    GridLayout:
        cols: 2
        rows: 4

        size_hint: (1-0.15,1-0.2)
        pos_hint: {"center_x": 0.5, "center_y": (1+(0.075))/2}

        spacing: 25
        padding: 35

        MenuButton:
            id: menu_button
            text: ""
            on_press: root.menu_animate(self)
            on_release: 
                root.on_release_animation()
                app.root.current = "menu_resources"
                root.manager.transition.direction = "down"
            Label:
                id: menu_label
                text: "Game Resources"
                font_size: 10
                center_x: self.parent.center_x
                center_y: self.parent.center_y - self.parent.center_y*0.11
            Image:
                id: menu_image
                source: "images/icons/genshin.png"
                size: (self.parent.width*0.5, self.parent.height*0.5)
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y


                
        MenuButton:
            id: menu_button
            text: ""
            on_press: root.menu_animate(self)
            on_release: 
                app.root.current = "menu_chars"
                root.manager.transition.direction = "down"
            Label:
                id: menu_label
                text: "Characters"
                font_size: 10
                center_x: self.parent.center_x
                center_y: self.parent.center_y - self.parent.center_y*0.11
            Image:
                id: menu_image
                source: "images/icons/paimon.png"
                size: (self.parent.width*0.5, self.parent.height*0.5)
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y


        MenuButton:
            id: menu_button
            text: ""
            on_press: root.menu_animate(self)
            on_release: 
                app.root.current = "menu_stats"
                root.manager.transition.direction = "down"
            Label:
                id: menu_label
                text: "Game Stats"
                font_size: 10
                center_x: self.parent.center_x
                center_y: self.parent.center_y - self.parent.center_y*0.14
            Image:
                id: menu_image
                source: "images/icons/list.png"
                size: (self.parent.width*0.45, self.parent.height*0.45)
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y


        MenuButton:
            id: menu_button
            text: ""
            on_press: root.menu_animate(self)
            on_release: 
                app.root.current = "menu_userprofile"
                root.manager.transition.direction = "down"
            Label:
                id: menu_label
                text: "User Profile"
                font_size: 10
                center_x: self.parent.center_x
                center_y: self.parent.center_y - self.parent.center_y*0.14
            Image:
                id: menu_image
                source: "images/icons/profile.png"
                size: (self.parent.width*0.50, self.parent.height*0.50)
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y
        MenuButton:
            id: menu_button
            text: ""
            on_press: root.menu_animate(self)
            Label:
                id: menu_label
                text: "Wish Log"
                font_size: 10
                center_x: self.parent.center_x
                center_y: self.parent.center_y - self.parent.center_y*0.20
            Image:
                id: menu_image
                source: "images/icons/fate.png"
                size: (self.parent.width*0.75, self.parent.height*0.75)
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y
        MenuButton:
            id: menu_button
            text: "Button6"
            on_press: root.menu_animate(self)
            Label:
                id: menu_label
                text: "About me"
                font_size: 10
                center_x: self.parent.center_x
                center_y: self.parent.center_y - self.parent.center_y*0.20
        MenuButton:
            id: menu_button
            text: "Button7"
            on_press: root.menu_animate(self)
            Label:
                id: menu_label
                text: "About me"
                font_size: 10
                center_x: self.parent.center_x
                center_y: self.parent.center_y - self.parent.center_y*0.34

    BoxLayout:
        size_hint: (1-0.25,1-0.2)
        pos_hint: {"center_x": 0.5, "center_y": 1-0.6}

        NavButton:
            text: ""
            size_hint: (0.04, 0.1)
            pos_hint: {"center_x": 0.5, "center_y": 0.5-0.4}
            font_name: "fonts/Heebo-Light.ttf"
            font_size: 18
            color: 1,1,1,1

            on_press:
                root.on_press_animation()
            on_release: 
                root.on_release_animation()
                app.root.current = "splashscreen"
                root.manager.transition.direction = "right"

            Image:
                id: back_image
                source: "images/button/back_hd.png"
                size: (self.parent.width*0.7, self.parent.height*0.7)
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y
                

<Menu_Stats>:
    name: "menu_stats"
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "Stats should appear here."

        Button:
            text: "Go back"
            on_release: 
                app.root.current = "mainmenu"
                root.manager.transition.direction = "up"


<Menu_Chars>:
    name: "menu_chars"
    GridLayout:
        rows: 3
        padding: 10
        spacing: 10
        rows_minimum: {0: self.parent.height*0.05, 1: self.parent.height*0.8, 2: self.parent.height*0.05}
        Label:
            text: "Characters"
            font_name: "fonts/GenshinFont.ttf"
            font_size: 20
        ScrollView:
            GridLayout:
                cols: 2
                padding: 30
                spacing: 50
                size_hint: 1, None
                height: self.minimum_height*3
                row_default_height: root.height*0.018

                on_parent:
                    for char in root.chars: self.add_widget(Button(background_normal=f'images/chars/icons/icon_{char["name"]}.png')); self.add_widget(Label(text=f"{char['name']}", pos_hint = {"center_x": 0.5, "center_y": 0.5}))
                # on_parent:
                #     if not self.children: [self.add_widget(Button(text=f'{char["name"]}', background_normal=f'images/chars/icons/icon_{char["name"]}.png')) for char in root.chars]
                #on_parent:
                    #if not self.children: [self.add_widget(Label(text=f"char['name']", pos_hint = {"center_x": 0.5, "center_y": -0.03})) for char in root.chars]
        Button:
            text: "Go back"
            on_release: 
                app.root.current = "mainmenu"
                root.manager.transition.direction = "up"



<Menu_Resources>:
    name: "menu_resources"
    BoxLayout:
        orientation: "vertical" 
        

        Button:
            text: "Go back"
            on_release: 
                app.root.current = "mainmenu"
                root.manager.transition.direction = "up"

####################################################################################################################################################
########################################################################## USERPROFILE #############################################################
####################################################################################################################################################
<Menu_Userprofile>:
    name: "menu_userprofile"
    GridLayout:
        cols: 1
        rows: 8
        padding: 25
        spacing: 10
        rows_minimum: {0: self.parent.height*0.06, 1: self.parent.height*0.04, 2: self.parent.height*0.60, 3: self.parent.height*0.02, 4: self.parent.height*0.08, 5: self.parent.height*0.06}
        Label:
            text: root.acct_details["name"]
            font_name: "fonts/GenshinFont.ttf"
            font_size: 45
            valign: "bottom"
            Image:
                source: "images/banners/hutao_profilebanner.png"
                width: root.width
                height: root.height
                center_x: self.width and self.parent.center_x
                center_y: self.height and self.parent.center_y
                opacity: 0.75
        Label:
            text: root.acct_details["uid"]
            font_name: "fonts/GenshinFont.ttf"
            font_size: 12

        BoxLayout:
            orientation: "vertical"
            spacing: 10
            InfoLabel:
                Label:
                    text: "Days Active"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y + self.parent.height*0.35
                    font_name: "fonts/Heebo-light.ttf"
                    font_size: 18
                Label:
                    text: f"{root.acct_ingame_info['stats']['active_days']}"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y + self.parent.height*0.15
                    font_name: "fonts/GenshinFont.ttf"
                    font_size: 35
                Label:
                    text: "Achievements Unlocked"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y - self.parent.height*0.08
                    font_name: "fonts/Heebo-light.ttf"
                    font_size: 18
                Label:
                    text: f"{root.acct_ingame_info['stats']['achievements']}"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y - self.parent.height*0.27
                    font_name: "fonts/GenshinFont.ttf"
                    font_size: 35
            BoxLayout:
                orientation: "horizontal"
                spacing: 10
                InfoLabel:
                    Image:
                        source: "images/icons/raiden.png"
                        size: (self.parent.width*0.85, self.parent.height*0.85)
                        center_x: self.width and self.parent.center_x
                        center_y: self.height and self.parent.center_y
                        opacity: 0.45
                    Label:
                        text: "Characters Owned"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y + self.parent.height*0.2
                        font_name: "fonts/Heebo-light.ttf"
                        font_size: 18
                    Label:
                        text: f"{root.acct_ingame_info['stats']['characters']}"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        font_name: "fonts/GenshinFont.ttf"
                        font_size: 35
                InfoLabel:
                    Image:
                        source: "images/icons/spiral_abyss.png"
                        size: (self.parent.width, self.parent.height)
                        center_x: self.width and self.parent.center_x
                        center_y: self.height and self.parent.center_y
                        opacity: 0.45
                    Label:
                        text: "Spiral Abyss"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y + self.parent.height*0.2
                        font_name: "fonts/Heebo-light.ttf"
                        font_size: 18
                    Label:
                        text: f"{root.acct_ingame_info['stats']['spiral_abyss']}"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        font_name: "fonts/GenshinFont.ttf"
                        font_size: 35
                    Label:
                        text: "Floor - Chamber"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y - self.parent.height*0.2
                        font_name: "fonts/Heebo-light.ttf"
                        font_size: 12

            BoxLayout:
                orientation: "horizontal"
                spacing: 10
                InfoLabel:
                    Image:
                        source: "images/icons/waypoint.png"
                        size: (self.parent.width*0.9, self.parent.height*0.9)
                        center_x: self.width and self.parent.center_x
                        center_y: self.height and self.parent.center_y
                        opacity: 0.45
                    Label:
                        text: "Unlocked Waypoints"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y + self.parent.height*0.2
                        font_name: "fonts/Heebo-light.ttf"
                        font_size: 14
                    Label:
                        text: f"{root.acct_ingame_info['stats']['unlocked_waypoints']}"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        font_name: "fonts/GenshinFont.ttf"
                        font_size: 35                   

                InfoLabel:
                    Image:
                        source: "images/icons/domain.png"
                        size: (self.parent.width*0.9, self.parent.height*0.9)
                        center_x: self.width and self.parent.center_x
                        center_y: self.height and self.parent.center_y
                        opacity: 0.45
                    Label:
                        text: "Unlocked Domains"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y + self.parent.height*0.2
                        font_name: "fonts/Heebo-light.ttf"
                        font_size: 18
                    Label:
                        text: f"{root.acct_ingame_info['stats']['unlocked_waypoints']}"
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        font_name: "fonts/GenshinFont.ttf"
                        font_size: 35                   

        Label:
            text: "Unlocked Chests"
            font_name: "fonts/Heebo-light.ttf"
            font_size: 18

        BoxLayout:
            orientation: "horizontal"
            spacing: 5
            InfoLabel:
                Label:
                    text: "Common"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y + self.parent.center_y*0.16
                    font_size: 12
                Label:
                    text: f"{root.acct_ingame_info['stats']['common_chests']}"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y*0.97
                    font_name: "fonts/GenshinFont.ttf"
                    font_size: 24        
            InfoLabel:
                Label:
                    text: "Exquisite"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y + self.parent.center_y*0.16
                    font_size: 12
                Label:
                    text: f"{root.acct_ingame_info['stats']['exquisite_chests']}"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y*0.97
                    font_name: "fonts/GenshinFont.ttf"
                    font_size: 24        
            InfoLabel:
                Label:
                    text: "Precious"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y + self.parent.center_y*0.16
                    font_size: 12
                Label:
                    text: f"{root.acct_ingame_info['stats']['precious_chests']}"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y*0.97
                    font_name: "fonts/GenshinFont.ttf"
                    font_size: 24        
            InfoLabel:
                Label:
                    text: "Luxurious"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y + self.parent.center_y*0.16
                    font_size: 12
                Label:
                    text: f"{root.acct_ingame_info['stats']['luxurious_chests']}"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y*0.97
                    font_name: "fonts/GenshinFont.ttf"
                    font_size: 24        

        Button:
            text: "Go back"
            on_release: 
                app.root.current = "mainmenu"
                root.manager.transition.direction = "up"
            center_y: self.height and self.parent.y*0.1
            center_x: self.width and self.parent.x*0.5
            width: self.parent.width*0.5
            height: self.parent.height*0.5


<TestLabel@Label>:
    font_size: 18
    font_name: "fonts/Heebo-Extrabold.ttf"
    canvas.before:
        Color:
            rgba: (183/225, 45/225, 247/225,0.4)
        Rectangle: 
            pos: self.pos
            size: self.size

<InfoLabel@Label>:
    canvas.before:
        Color:
            rgba: (229/255, 63/255, 113/255, 1)
        RoundedRectangle:
            size: (self.width, self.height)
            pos: (self.x, self.y)
            radius: [12]

<MenuButton@Button>:
    font_size: 16
    font_name: "fonts/Heebo-Regular.ttf"
    background_color: 0, 0, 0, 0
    background_normal: ""
    canvas.before:
        Color:
            rgba: (229/255, 63/255, 113/255, 1)
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [24]


<NavButton@Button>:
    font_name: "fonts/Heebo-Regular.ttf"
    background_color: 0, 0, 0, 0
    background_normal: ""
    canvas.before:
        Color:
            rgba: (229/255, 63/255, 113/255, 0)
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [18]
